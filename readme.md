1. Попасть в систему без пароля несколькими способами

Способ № 1
При загрузке системы удерживать на клавиатуре кнопку e (английскую), чтобы попасть в меню параметров загрузки ядра.
Найти строчку, которая начинается на linux16 /vmlinuz
В конце строчки дописать rw (это даст возможность управления системой в режиме чтения/записи) и init=/bin/bash
для получения доступа к строке bash. Альтернативно init=/bin/sh
Нажать Ctrl+x для продолжения загрузки ядра.
После загрузки с прерыванием доступна строка bash, чтение и запись, а также вход в режим root
Действия подкреплены скриншотами 1.png 2.png 3.png

Способ № 2
При загрузке системы удерживать на клавиатуре кнопку e (английскую), чтобы попасть в меню параметров загрузки ядра.
Найти строчку, которая начинается на linux16 /vmlinuz
До значения языка LANG вписать параметр rd.break
Нажать Ctrl+x для продолжения загрузки ядра.
Далее, 
$ mount -o remount,rw /sysroot/
$ chroot /sysroot passwd root
После смены пароля для root
При использовании SELinux добавляем файл .autorelabel
$touch /.autorelabel
чтобы ядро после перезагрузки запустило autorelabeling
Результат: Мы вошли в систему, сменили пароль для root используя rd.break и chroot
Действия подкреплены скриншотами 4.png 5.png 6.png 9.png

Способ № 3
При загрузке системы удерживать на клавиатуре кнопку e (английскую), чтобы попасть в меню параметров загрузки ядра.
Найти строчку, которая начинается на linux16 /vmlinuz
Меняем значение ro на rw и дописываем через пробел init=/sysroot/bin/sh
Нажать Ctrl+x для продолжения загрузки ядра.
входим в аварийный режим управления. 
Далее? входим в режим chroot и меняем пароль root:
$ chroot /sysroot
$ passwd root
При использовании SELinux добавляем файл .autorelabel
$ touch /.autorelabel
чтобы ядро после перезагрузки запустило autorelabeling
Выполняем reboot
Результат: Мы вошли в систему, сменили пароль для root используя init=/sysroot/bin/sh и chroot
Действия подкреплены скриншотами 10.png 11.png

2. Установить систему с LVM, после чего переименовать VG

Использую Vagrantfile с настройками LVM
После авторизации вызываю команду

$ sudo vgs
Возвращается значение о группах томов. В моем случае
VolGroup00

Выполняем переименование
$ sudo vgrename VolGroup00 NewName
Система возвращает сообщение об успешном переименовании группы
Скриншот 12.png


Запоминаем названием и теперь редактируем файлы

/etc/fstab  Скрин. 13.png
/etc/default/grub   14.png
/boot/grub2/grub.cfg   15.png

Везде заменяем старое название VolGroup00 на новое NewName

Пересоздаем initrd image, чтобы он знал новое название Volume Group:

$ mkinitrd -f -v /boot/initramfs-$(uname -r).img $(uname -r)
недостающие при этой операции модули будут установлены автоматически

Скрин 16.png

Выполняем перезагрузку системы и, если всё было выполнено правильно, мы получаем новое значение Volume Groiup  при запросу командой vgs
Скрин 17.png

Действия и результат подкреплены скриншотами и файлами 
- fstab
- grub
- grub.cfg

3. Добавить модуль в initrd

Создаём директорию в каталоге /usr/lib/dracut/modules.d/

$ mkdir /usr/lib/dracut/modules.d/01test

Создаем файл 

module-setup.sh

с содержимым:
#!/bin/bash

check() {
    return 0
}
depends() {
    return 0
}
install() {
    inst_hook cleanup 00 "${moddir}/test.sh"
}


И файл:
test.sh

С содержимым
#!/bin/bash

exec 0<>/dev/console 1<>/dev/console 2<>/dev/console
cat <<'msgend'

Wassup! 
< I'm dracut module >
 -------------------
(\__/)
(='.'=)
(").|.(")

msgend
sleep 20
echo " continuing...."


Помечаем файлы как исполянемые

sudo chmod +x /usr/lib/dracut/modules.d/test/init.sh /usr/lib/dracut/modules.d/test/logo.sh

Пересобираем модуль initrd
mkinitrd -f -v /boot/initramfs-$(uname -r).img $(uname -r)

После пересборки редактируем /boot/grub2/grub.cfg отключая опции
rghb и quiet, чтобы увидеть вывод при загрузке

Скрин 22.png




